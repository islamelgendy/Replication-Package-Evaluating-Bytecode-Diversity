public void testGetOptionProperties() throws Exception { String[] args = new String[] { "-Dparam1=value1", "-Dparam2=value2", "-Dparam3", "-Dparam4=value4", "-D", "--property", "foo=bar" }; Options options = new Options(); options.addOption(OptionBuilder.withValueSeparator().hasOptionalArgs(2).create('D')); options.addOption(OptionBuilder.withValueSeparator().hasArgs(2).withLongOpt("property").create()); Parser parser = new GnuParser(); CommandLine cl = parser.parse(options, args); Properties props = cl.getOptionProperties("D"); assertNotNull("null properties", props); assertEquals("number of properties in " + props, 4, props.size()); assertEquals("property 1", "value1", props.getProperty("param1")); assertEquals("property 2", "value2", props.getProperty("param2")); assertEquals("property 3", "true", props.getProperty("param3")); assertEquals("property 4", "value4", props.getProperty("param4")); assertEquals("property with long format", "bar", cl.getOptionProperties("property").getProperty("foo")); }
public void testGetOptions() { CommandLine cmd = new CommandLine(); assertNotNull(cmd.getOptions()); assertEquals(0, cmd.getOptions().length); cmd.addOption(new Option("a", null)); cmd.addOption(new Option("b", null)); cmd.addOption(new Option("c", null)); assertEquals(3, cmd.getOptions().length); }
public void testGetParsedOptionValue() throws Exception { Options options = new Options(); options.addOption(OptionBuilder.hasArg().withType(Number.class).create("i")); options.addOption(OptionBuilder.hasArg().create("f")); CommandLineParser parser = new DefaultParser(); CommandLine cmd = parser.parse(options, new String[] { "-i", "123", "-f", "foo" }); assertEquals(123, ((Number) cmd.getParsedOptionValue("i")).intValue()); assertEquals("foo", cmd.getParsedOptionValue("f")); }
public void testSingleOptionFromGroup() throws Exception { String[] args = new String[] { "-f" }; CommandLine cl = parser.parse( _options, args); assertTrue( "Confirm -r is NOT set", !cl.hasOption("r") ); assertTrue( "Confirm -f is set", cl.hasOption("f") ); assertTrue( "Confirm -d is NOT set", !cl.hasOption("d") ); assertTrue( "Confirm -s is NOT set", !cl.hasOption("s") ); assertTrue( "Confirm -c is NOT set", !cl.hasOption("c") ); assertTrue( "Confirm no extra args", cl.getArgList().size() == 0); }
public void testSingleOption() throws Exception { String[] args = new String[] { "-r" }; CommandLine cl = parser.parse( _options, args); assertTrue( "Confirm -r is set", cl.hasOption("r") ); assertTrue( "Confirm -f is NOT set", !cl.hasOption("f") ); assertTrue( "Confirm -d is NOT set", !cl.hasOption("d") ); assertTrue( "Confirm -s is NOT set", !cl.hasOption("s") ); assertTrue( "Confirm -c is NOT set", !cl.hasOption("c") ); assertTrue( "Confirm no extra args", cl.getArgList().size() == 0); }
public void testTwoValidOptions() throws Exception { String[] args = new String[] { "-r", "-f" }; CommandLine cl = parser.parse( _options, args); assertTrue( "Confirm -r is set", cl.hasOption("r") ); assertTrue( "Confirm -f is set", cl.hasOption("f") ); assertTrue( "Confirm -d is NOT set", !cl.hasOption("d") ); assertTrue( "Confirm -s is NOT set", !cl.hasOption("s") ); assertTrue( "Confirm -c is NOT set", !cl.hasOption("c") ); assertTrue( "Confirm no extra args", cl.getArgList().size() == 0); }
public void testSingleLongOption() throws Exception { String[] args = new String[] { "--file" }; CommandLine cl = parser.parse( _options, args); assertTrue( "Confirm -r is NOT set", !cl.hasOption("r") ); assertTrue( "Confirm -f is set", cl.hasOption("f") ); assertTrue( "Confirm -d is NOT set", !cl.hasOption("d") ); assertTrue( "Confirm -s is NOT set", !cl.hasOption("s") ); assertTrue( "Confirm -c is NOT set", !cl.hasOption("c") ); assertTrue( "Confirm no extra args", cl.getArgList().size() == 0); }
public void testTwoValidLongOptions() throws Exception { String[] args = new String[] { "--revision", "--file" }; CommandLine cl = parser.parse( _options, args); assertTrue( "Confirm -r is set", cl.hasOption("r") ); assertTrue( "Confirm -f is set", cl.hasOption("f") ); assertTrue( "Confirm -d is NOT set", !cl.hasOption("d") ); assertTrue( "Confirm -s is NOT set", !cl.hasOption("s") ); assertTrue( "Confirm -c is NOT set", !cl.hasOption("c") ); assertTrue( "Confirm no extra args", cl.getArgList().size() == 0); }
public void testNoOptionsExtraArgs() throws Exception { String[] args = new String[] { "arg1", "arg2" }; CommandLine cl = parser.parse( _options, args); assertTrue( "Confirm -r is NOT set", !cl.hasOption("r") ); assertTrue( "Confirm -f is NOT set", !cl.hasOption("f") ); assertTrue( "Confirm -d is NOT set", !cl.hasOption("d") ); assertTrue( "Confirm -s is NOT set", !cl.hasOption("s") ); assertTrue( "Confirm -c is NOT set", !cl.hasOption("c") ); assertTrue( "Confirm TWO extra args", cl.getArgList().size() == 2); }
public void testTwoOptionsFromGroup() throws Exception { String[] args = new String[] { "-f", "-d" }; try { parser.parse( _options, args); fail( "two arguments from group not allowed" ); } catch (AlreadySelectedException e) { assertNotNull("null option group", e.getOptionGroup()); assertEquals("selected option", "f", e.getOptionGroup().getSelected()); assertEquals("option", "d", e.getOption().getOpt()); } }
public void testTwoLongOptionsFromGroup() throws Exception { String[] args = new String[] { "--file", "--directory" }; try { parser.parse(_options, args); fail( "two arguments from group not allowed" ); } catch (AlreadySelectedException e) { assertNotNull("null option group", e.getOptionGroup()); assertEquals("selected option", "f", e.getOptionGroup().getSelected()); assertEquals("option", "d", e.getOption().getOpt()); } }
public void testTwoOptionsFromDifferentGroup() throws Exception { String[] args = new String[] { "-f", "-s" }; CommandLine cl = parser.parse( _options, args); assertTrue( "Confirm -r is NOT set", !cl.hasOption("r") ); assertTrue( "Confirm -f is set", cl.hasOption("f") ); assertTrue( "Confirm -d is NOT set", !cl.hasOption("d") ); assertTrue( "Confirm -s is set", cl.hasOption("s") ); assertTrue( "Confirm -c is NOT set", !cl.hasOption("c") ); assertTrue( "Confirm NO extra args", cl.getArgList().size() == 0); }
public void testTwoOptionsFromGroupWithProperties() throws Exception { String[] args = new String[] { "-f" }; Properties properties = new Properties(); properties.put("d", "true"); CommandLine cl = parser.parse( _options, args, properties); assertTrue(cl.hasOption("f")); assertTrue(!cl.hasOption("d")); }
public void testValidLongOnlyOptions() throws Exception { CommandLine cl1 = parser.parse(_options, new String[]{"--export"}); assertTrue("Confirm --export is set", cl1.hasOption("export")); CommandLine cl2 = parser.parse(_options, new String[]{"--import"}); assertTrue("Confirm --import is set", cl2.hasOption("import")); }
public void testToString() { OptionGroup group1 = new OptionGroup(); group1.addOption(new Option(null, "foo", false, "Foo")); group1.addOption(new Option(null, "bar", false, "Bar")); if (!"[--bar Bar, --foo Foo]".equals(group1.toString())) { assertEquals("[--foo Foo, --bar Bar]", group1.toString()); } OptionGroup group2 = new OptionGroup(); group2.addOption(new Option("f", "foo", false, "Foo")); group2.addOption(new Option("b", "bar", false, "Bar")); if (!"[-b Bar, -f Foo]".equals(group2.toString())) { assertEquals("[-f Foo, -b Bar]", group2.toString()); } }
public void testGetNames() { OptionGroup group = new OptionGroup(); group.addOption(OptionBuilder.create('a')); group.addOption(OptionBuilder.create('b')); assertNotNull("null names", group.getNames()); assertEquals(2, group.getNames().size()); assertTrue(group.getNames().contains("a")); assertTrue(group.getNames().contains("b")); }
public void testClear() { TestOption option = new TestOption("x", true, ""); assertEquals(0, option.getValuesList().size()); option.addValue("a"); assertEquals(1, option.getValuesList().size()); option.clearValues(); assertEquals(0, option.getValuesList().size()); }
public void testClone() throws CloneNotSupportedException { TestOption a = new TestOption("a", true, ""); TestOption b = (TestOption) a.clone(); assertEquals(a, b); assertNotSame(a, b); a.setDescription("a"); assertEquals("", b.getDescription()); b.setArgs(2); b.addValue("b1"); b.addValue("b2"); assertEquals(1, a.getArgs()); assertEquals(0, a.getValuesList().size()); assertEquals(2, b.getValues().length); }
public void testSubclass() throws CloneNotSupportedException { Option option = new DefaultOption("f", "file", "myfile.txt"); Option clone = (Option) option.clone(); assertEquals("myfile.txt", clone.getValue()); assertEquals(DefaultOption.class, clone.getClass()); }
public void testHasArgName() { Option option = new Option("f", null); option.setArgName(null); assertFalse(option.hasArgName()); option.setArgName(""); assertFalse(option.hasArgName()); option.setArgName("file"); assertTrue(option.hasArgName()); }
public void testHasArgs() { Option option = new Option("f", null); option.setArgs(0); assertFalse(option.hasArgs()); option.setArgs(1); assertFalse(option.hasArgs()); option.setArgs(10); assertTrue(option.hasArgs()); option.setArgs(Option.UNLIMITED_VALUES); assertTrue(option.hasArgs()); option.setArgs(Option.UNINITIALIZED); assertFalse(option.hasArgs()); }
public void testGetValue() { Option option = new Option("f", null); option.setArgs(Option.UNLIMITED_VALUES); assertEquals("default", option.getValue("default")); assertEquals(null, option.getValue(0)); option.addValueForProcessing("foo"); assertEquals("foo", option.getValue()); assertEquals("foo", option.getValue(0)); assertEquals("foo", option.getValue("default")); }
public void testCompleteOption( ) { Option simple = OptionBuilder.withLongOpt( "simple option") .hasArg( ) .isRequired( ) .hasArgs( ) .withType( Float.class ) .withDescription( "this is a simple option" ) .create( 's' ); assertEquals( "s", simple.getOpt() ); assertEquals( "simple option", simple.getLongOpt() ); assertEquals( "this is a simple option", simple.getDescription() ); assertEquals( simple.getType(), Float.class ); assertTrue( simple.hasArg() ); assertTrue( simple.isRequired() ); assertTrue( simple.hasArgs() ); }
public void testTwoCompleteOptions( ) { Option simple = OptionBuilder.withLongOpt( "simple option") .hasArg( ) .isRequired( ) .hasArgs( ) .withType( Float.class ) .withDescription( "this is a simple option" ) .create( 's' ); assertEquals( "s", simple.getOpt() ); assertEquals( "simple option", simple.getLongOpt() ); assertEquals( "this is a simple option", simple.getDescription() ); assertEquals( simple.getType(), Float.class ); assertTrue( simple.hasArg() ); assertTrue( simple.isRequired() ); assertTrue( simple.hasArgs() ); simple = OptionBuilder.withLongOpt( "dimple option") .hasArg( ) .withDescription( "this is a dimple option" ) .create( 'd' ); assertEquals( "d", simple.getOpt() ); assertEquals( "dimple option", simple.getLongOpt() ); assertEquals( "this is a dimple option", simple.getDescription() ); assertEquals( String.class, simple.getType() ); assertTrue( simple.hasArg() ); assertTrue( !simple.isRequired() ); assertTrue( !simple.hasArgs() ); }
public void testBaseOptionCharOpt() { Option base = OptionBuilder.withDescription( "option description") .create( 'o' ); assertEquals( "o", base.getOpt() ); assertEquals( "option description", base.getDescription() ); assertTrue( !base.hasArg() ); }
public void testBaseOptionStringOpt() { Option base = OptionBuilder.withDescription( "option description") .create( "o" ); assertEquals( "o", base.getOpt() ); assertEquals( "option description", base.getDescription() ); assertTrue( !base.hasArg() ); }
public void testSpecialOptChars() throws Exception { Option opt1 = OptionBuilder.withDescription("help options").create('?'); assertEquals("?", opt1.getOpt()); Option opt2 = OptionBuilder.withDescription("read from stdin").create('@'); assertEquals("@", opt2.getOpt()); try { OptionBuilder.create(' '); fail( "IllegalArgumentException not caught" ); } catch (IllegalArgumentException e) { } }
public void testOptionArgNumbers() { Option opt = OptionBuilder.withDescription( "option description" ) .hasArgs( 2 ) .create( 'o' ); assertEquals( 2, opt.getArgs() ); }
public void testIllegalOptions() { try { OptionBuilder.withDescription( "option description" ).create( '"' ); fail( "IllegalArgumentException not caught" ); } catch( IllegalArgumentException exp ) { } try { Option opt = OptionBuilder.create( "opt`" ); fail( "IllegalArgumentException not caught" ); } catch( IllegalArgumentException exp ) { } try { Option opt = OptionBuilder.create( "opt" ); } catch( IllegalArgumentException exp ) { fail( "IllegalArgumentException caught" ); } }
public void testCreateIncompleteOption() { try { OptionBuilder.hasArg().create(); fail("Incomplete option should be rejected"); } catch (IllegalArgumentException e) { OptionBuilder.create( "opt" ); } }
public void testBuilderIsResettedAlways() { try { OptionBuilder.withDescription("JUnit").create('"'); fail("IllegalArgumentException expected"); } catch (IllegalArgumentException e) { } assertNull("we inherited a description", OptionBuilder.create('x').getDescription()); try { OptionBuilder.withDescription("JUnit").create(); fail("IllegalArgumentException expected"); } catch (IllegalArgumentException e) { } assertNull("we inherited a description", OptionBuilder.create('x').getDescription()); }
public void testSimple() { Options opts = new Options(); opts.addOption("a", false, "toggle -a"); opts.addOption("b", true, "toggle -b"); assertTrue(opts.hasOption("a")); assertTrue(opts.hasOption("b")); }
public void testDuplicateSimple() { Options opts = new Options(); opts.addOption("a", false, "toggle -a"); opts.addOption("a", true, "toggle -a*"); assertEquals("last one in wins", "toggle -a*", opts.getOption("a").getDescription()); }
public void testLong() { Options opts = new Options(); opts.addOption("a", "--a", false, "toggle -a"); opts.addOption("b", "--b", true, "set -b"); assertTrue(opts.hasOption("a")); assertTrue(opts.hasOption("b")); }
public void testDuplicateLong() { Options opts = new Options(); opts.addOption("a", "--a", false, "toggle -a"); opts.addOption("a", "--a", false, "toggle -a*"); assertEquals("last one in wins", "toggle -a*", opts.getOption("a").getDescription()); }
public void testHelpOptions() { Option longOnly1 = OptionBuilder.withLongOpt("long-only1").create(); Option longOnly2 = OptionBuilder.withLongOpt("long-only2").create(); Option shortOnly1 = OptionBuilder.create("1"); Option shortOnly2 = OptionBuilder.create("2"); Option bothA = OptionBuilder.withLongOpt("bothA").create("a"); Option bothB = OptionBuilder.withLongOpt("bothB").create("b"); Options options = new Options(); options.addOption(longOnly1); options.addOption(longOnly2); options.addOption(shortOnly1); options.addOption(shortOnly2); options.addOption(bothA); options.addOption(bothB); Collection allOptions = new ArrayList(); allOptions.add(longOnly1); allOptions.add(longOnly2); allOptions.add(shortOnly1); allOptions.add(shortOnly2); allOptions.add(bothA); allOptions.add(bothB); Collection helpOptions = options.helpOptions(); assertTrue("Everything in all should be in help", helpOptions.containsAll(allOptions)); assertTrue("Everything in help should be in all", allOptions.containsAll(helpOptions)); }
public void testMissingOptionException() throws ParseException { Options options = new Options(); options.addOption(OptionBuilder.isRequired().create("f")); try { new PosixParser().parse(options, new String[0]); fail("Expected MissingOptionException to be thrown"); } catch (MissingOptionException e) { assertEquals("Missing required option: f", e.getMessage()); } }
public void testMissingOptionsException() throws ParseException { Options options = new Options(); options.addOption(OptionBuilder.isRequired().create("f")); options.addOption(OptionBuilder.isRequired().create("x")); try { new PosixParser().parse(options, new String[0]); fail("Expected MissingOptionException to be thrown"); } catch (MissingOptionException e) { assertEquals("Missing required options: f, x", e.getMessage()); } }
public void testToString() { Options options = new Options(); options.addOption("f", "foo", true, "Foo"); options.addOption("b", "bar", false, "Bar"); String s = options.toString(); assertNotNull("null string returned", s); assertTrue("foo option missing", s.toLowerCase().indexOf("foo") != -1); assertTrue("bar option missing", s.toLowerCase().indexOf("bar") != -1); }
public void testGetOptionsGroups() { Options options = new Options(); OptionGroup group1 = new OptionGroup(); group1.addOption(OptionBuilder.create('a')); group1.addOption(OptionBuilder.create('b')); OptionGroup group2 = new OptionGroup(); group2.addOption(OptionBuilder.create('x')); group2.addOption(OptionBuilder.create('y')); options.addOptionGroup(group1); options.addOptionGroup(group2); assertNotNull(options.getOptionGroups()); assertEquals(2, options.getOptionGroups().size()); }
public void testGetMatchingOpts() { Options options = new Options(); options.addOption(OptionBuilder.withLongOpt("version").create()); options.addOption(OptionBuilder.withLongOpt("verbose").create()); assertTrue(options.getMatchingOptions("foo").isEmpty()); assertEquals(1, options.getMatchingOptions("version").size()); assertEquals(2, options.getMatchingOptions("ver").size()); }
public void testOptionAndOptionWithArgument() throws Exception { String[] args = new String[]{ "-p", "-attr", "p" }; CommandLine cl = parser.parse(options, args); assertTrue("Confirm -p is set", cl.hasOption("p")); assertTrue("Confirm -attr is set", cl.hasOption("attr")); assertTrue("Confirm arg of -attr", cl.getOptionValue("attr").equals("p")); assertTrue("Confirm all arguments recognized", cl.getArgs().length == 0); }
public void testOptionWithArgument() throws Exception { String[] args = new String[]{ "-attr", "p" }; CommandLine cl = parser.parse(options, args); assertFalse("Confirm -p is set", cl.hasOption("p")); assertTrue("Confirm -attr is set", cl.hasOption("attr")); assertTrue("Confirm arg of -attr", cl.getOptionValue("attr").equals("p")); assertTrue("Confirm all arguments recognized", cl.getArgs().length == 0); }
public void testOption() throws Exception { String[] args = new String[]{ "-p" }; CommandLine cl = parser.parse(options, args); assertTrue("Confirm -p is set", cl.hasOption("p")); assertFalse("Confirm -attr is not set", cl.hasOption("attr")); assertTrue("Confirm all arguments recognized", cl.getArgs().length == 0); }
public void testSimplePattern() throws Exception { Options options = PatternOptionBuilder.parsePattern("a:b@cde>f+n%t/m*z#"); String[] args = new String[] {"-c", "-a", "foo", "-b", "java.util.Vector", "-e", "build.xml", "-f", "java.util.Calendar", "-n", "4.5", "-t", "http://commons.apache.org", "-z", "Thu Jun 06 17:48:57 EDT 2002", "-m", "test*"}; CommandLineParser parser = new PosixParser(); CommandLine line = parser.parse(options, args); assertEquals("flag a", "foo", line.getOptionValue("a")); assertEquals("string flag a", "foo", line.getOptionObject("a")); assertEquals("object flag b", new Vector(), line.getOptionObject("b")); assertTrue("boolean true flag c", line.hasOption("c")); assertFalse("boolean false flag d", line.hasOption("d")); assertEquals("file flag e", new File("build.xml"), line.getOptionObject("e")); assertEquals("class flag f", Calendar.class, line.getOptionObject("f")); assertEquals("number flag n", new Double(4.5), line.getOptionObject("n")); assertEquals("url flag t", new URL("http://commons.apache.org"), line.getOptionObject("t")); assertEquals("flag a", "foo", line.getOptionValue('a')); assertEquals("string flag a", "foo", line.getOptionObject('a')); assertEquals("object flag b", new Vector(), line.getOptionObject('b')); assertTrue("boolean true flag c", line.hasOption('c')); assertFalse("boolean false flag d", line.hasOption('d')); assertEquals("file flag e", new File("build.xml"), line.getOptionObject('e')); assertEquals("class flag f", Calendar.class, line.getOptionObject('f')); assertEquals("number flag n", new Double(4.5), line.getOptionObject('n')); assertEquals("url flag t", new URL("http://commons.apache.org"), line.getOptionObject('t')); try { assertEquals("files flag m", new File[0], line.getOptionObject('m')); fail("Multiple files are not supported yet, should have failed"); } catch(UnsupportedOperationException uoe) { } try { assertEquals("date flag z", new Date(1023400137276L), line.getOptionObject('z')); fail("Date is not supported yet, should have failed"); } catch(UnsupportedOperationException uoe) { } }
public void testEmptyPattern() throws Exception { Options options = PatternOptionBuilder.parsePattern(""); assertTrue(options.getOptions().isEmpty()); }
public void testUntypedPattern() throws Exception { Options options = PatternOptionBuilder.parsePattern("abc"); CommandLineParser parser = new PosixParser(); CommandLine line = parser.parse(options, new String[] { "-abc" }); assertTrue(line.hasOption('a')); assertNull("value a", line.getOptionObject('a')); assertTrue(line.hasOption('b')); assertNull("value b", line.getOptionObject('b')); assertTrue(line.hasOption('c')); assertNull("value c", line.getOptionObject('c')); }
public void testNumberPattern() throws Exception { Options options = PatternOptionBuilder.parsePattern("n%d%x%"); CommandLineParser parser = new PosixParser(); CommandLine line = parser.parse(options, new String[] { "-n", "1", "-d", "2.1", "-x", "3,5" }); assertEquals("n object class", Long.class, line.getOptionObject("n").getClass()); assertEquals("n value", new Long(1), line.getOptionObject("n")); assertEquals("d object class", Double.class, line.getOptionObject("d").getClass()); assertEquals("d value", new Double(2.1), line.getOptionObject("d")); assertNull("x object", line.getOptionObject("x")); }
public void testClassPattern() throws Exception { Options options = PatternOptionBuilder.parsePattern("c+d+"); CommandLineParser parser = new PosixParser(); CommandLine line = parser.parse(options, new String[] { "-c", "java.util.Calendar", "-d", "System.DateTime" }); assertEquals("c value", Calendar.class, line.getOptionObject("c")); assertNull("d value", line.getOptionObject("d")); }
public void testObjectPattern() throws Exception { Options options = PatternOptionBuilder.parsePattern("o@i@n@"); CommandLineParser parser = new PosixParser(); CommandLine line = parser.parse(options, new String[] { "-o", "java.lang.String", "-i", "java.util.Calendar", "-n", "System.DateTime" }); assertEquals("o value", "", line.getOptionObject("o")); assertNull("i value", line.getOptionObject("i")); assertNull("n value", line.getOptionObject("n")); }
public void testURLPattern() throws Exception { Options options = PatternOptionBuilder.parsePattern("u/v/"); CommandLineParser parser = new PosixParser(); CommandLine line = parser.parse(options, new String[] { "-u", "http://commons.apache.org", "-v", "foo://commons.apache.org" }); assertEquals("u value", new URL("http://commons.apache.org"), line.getOptionObject("u")); assertNull("v value", line.getOptionObject("v")); }
public void testExistingFilePattern() throws Exception { Options options = PatternOptionBuilder.parsePattern("f<"); CommandLineParser parser = new PosixParser(); CommandLine line = parser.parse(options, new String[] { "-f", "test.properties" }); assertEquals("f value", new File("test.properties"), line.getOptionObject("f")); }
public void testRequiredOption() throws Exception { Options options = PatternOptionBuilder.parsePattern("!n%m%"); CommandLineParser parser = new PosixParser(); try { parser.parse(options, new String[]{""}); fail("MissingOptionException wasn't thrown"); } catch (MissingOptionException e) { assertEquals(1, e.getMissingOptions().size()); assertTrue(e.getMissingOptions().contains("n")); } }
